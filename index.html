<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Attendance App</title>
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#007bff" />

    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <h1>Attendance App</h1>

      <!-- Date selector -->
      <div class="date-section">
        <label for="dateSelector">Select Date: </label>
        <input type="date" id="dateSelector" />
        <span>(Only today editable)</span>
      </div>

      <!-- Search Interface -->
      <div class="search-section">
        <h2>Search Student</h2>
        <input type="text" id="searchInput" placeholder="Enter ID or Name" />
        <button onclick="searchStudent()">Search</button>
        <div id="searchResult"></div>
      </div>

      <!-- Attendance Table -->
      <table id="attendanceTable">
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Present</th>
            <th>Total Present</th>
            <th>Total Absent</th>
            <th>Total Days</th>
            <th>Amount</th>
            <th>Paid Date</th>
            <th>Expire Date</th>
          </tr>
        </thead>
        <tbody>
          <!-- JS will populate -->
        </tbody>
      </table>

      <!-- Excel & Student Buttons -->
      <input type="file" id="fileInput" accept=".xlsx,.xls" />
      <button class="btn-load" onclick="loadFromExcel()">
        Load Students from Excel
      </button>
      <button class="btn-add" onclick="addNewStudent()">Add New Student</button>
      <td>
        <button class="delete-btn" onclick="deleteStudent()">
          Delete
        </button>
      </td>
      <button class="btn-export" onclick="exportExcel()">
        Export Attendance to Excel
      </button>
    </div>

    <!-- SheetJS library for Excel -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

    <script src="script.js"></script>
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", async () => {
          try {
            const reg = await navigator.serviceWorker.register("sw.js");
            console.log("✅ Service Worker registered:", reg.scope);
          } catch (err) {
            console.log("❌ Service Worker failed:", err);
          }
        });
      }
    </script>
  </body>
</html>
